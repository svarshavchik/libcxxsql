#
# Copyright 2013 Double Precision, Inc.
# See COPYING for distribution information.
#

Summary: LibCXX SQL Library
Name: libcxxsql
Version: @VERSION@
Release: 1%{?extrarelease}
License: GPL
Group: Development/Libraries
Source0: %{name}-%{version}.tar.bz2

%define _hardened_build 1

BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
BuildRequires: libcxxbase-devel >= 0.5
BuildRequires: gmp-devel >= 5.1
BuildRequires: unixODBC-devel

%description
This package installs the LibCXX SQL library. This package must be installed
to run software that's linked against libcxxsql.

Some software may also need to need the unixODBC-gui-qt package, which
contains code for a GUI prompt to select an SQL data source, that some
applications use.

%package gmp
Group: Development/Libraries
Summary: LibCXX SQL support for the GNU MP library
Requires: %{name} = 0:%{version}-%{release}

%description gmp
This package installs an additional library that's needed to support
inserting and selecting libgmp's mpf_class values from an SQL database.

%package devel
Group: Development/Libraries
Summary: LibCXX SQL development libraries
Requires: %{name} = 0:%{version}-%{release}
Requires: %{name}-gmp = 0:%{version}-%{release}

%description devel
This package installs files needed to develop applications that use
LibCXX SQL development libraries.

%prep
%setup -q
%configure

%build
%{__make} %{_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
%{__make} install DESTDIR=$RPM_BUILD_ROOT
rm -f $RPM_BUILD_ROOT%{_libdir}/*.la

%clean
rm -rf $RPM_BUILD_ROOT

%post -p /sbin/ldconfig
%postun -p /sbin/ldconfig

%post gmp -p /sbin/ldconfig
%postun gmp -p /sbin/ldconfig

%files
%defattr(-,root,root,-)
%{_libdir}/libcxxsql.so.*

%files gmp
%defattr(-,root,root,-)
%{_libdir}/libcxxsqldecimal.so.*

%files devel
%defattr(-,root,root,-)
%{_libdir}/*.so
%{_libdir}/*.a
%{_libdir}/pkgconfig/*
%{_includedir}/x/sql
%{_datadir}/*/*

%changelog
* Mon Sep  2 2013 Sam Varshavchik <mrsam@octopus.email-scan.com>
- Put libcxxsqldecimal into a separate subpackage

* Sat Jun  1 2013 Sam Varshavchik <mrsam@octopus.email-scan.com>
- Initial version
